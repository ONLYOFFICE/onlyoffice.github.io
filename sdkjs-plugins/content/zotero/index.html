<!--
 (c) Copyright Ascensio System SIA 2020

 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

     http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.
 -->
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Zotero</title>
    <script src="vendor/jquery/jquery-3.7.1.min.js"></script>
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <link rel="stylesheet" href="https://onlyoffice.github.io/sdkjs-plugins/v1/plugins.css" />
    <script src="https://onlyoffice.github.io/sdkjs-plugins/v1/plugins.js"></script>
    <script src="https://onlyoffice.github.io/sdkjs-plugins/v1/plugins-ui.js"></script>
    <link rel="stylesheet" href="resources/css/plugin_style.css" />
    <link rel="stylesheet" href="resources/css/components.css" />

    <script defer src="scripts/thirdparty/fetch.umd.js"></script>
    <script defer src="scripts/thirdparty/promise-polyfill.min.js"></script>
    <script defer src="scripts/thirdparty/url-polyfill.min.js"></script>
    <script defer src="scripts/citeproc/citeproc_commonjs.js"></script>

    <script defer src="scripts/csl/citation/citation-item-data.js"></script>
    <script defer src="scripts/csl/citation/citation-item.js"></script>
    <script defer src="scripts/csl/citation/citation.js"></script>
    <script defer src="scripts/csl/citation/storage.js"></script>

    <script defer src="scripts/csl/locales/locales-manager.js"></script>
    <script defer src="scripts/csl/styles/styles-manager.js"></script>
    <script defer src="scripts/csl/styles/style-parser.js"></script>
    <script defer src="scripts/csl/styles/storage.js"></script>

    <script defer src="scripts/services/citation-doc-service.js"></script>
    <script defer src="scripts/services/citation-service.js"></script>
    <script defer src="scripts/services/translate-service.js"></script>

    <script defer src="scripts/shared/ui/input.js"></script>
    <script defer src="scripts/shared/ui/search-input.js"></script>
    <script defer src="scripts/shared/ui/selectbox.js"></script>
    <script defer src="scripts/shared/ui/button.js"></script>
    <script defer src="scripts/shared/ui/message.js"></script>
    <script defer src="scripts/shared/components/search-filter.js"></script>
    <script defer src="scripts/shared/components/select-citation.js"></script>

    <script defer src="scripts/zotero/zotero-environment.js"></script>
    <script defer src="scripts/zotero/zotero-api-checker.js"></script>
    <script defer src="scripts/zotero/zotero.js"></script>

    <script defer src="scripts/connection.js"></script>
    <script defer src="scripts/router.js"></script>
    <script defer src="scripts/code.js"></script>
</head>

<body id="body" spellcheck="false" class="noselect">
    <div id="loader" class="cssload-container hidden">
        <div class="cssload-loading"><i></i><i></i><i></i><i></i></div>
    </div>
    <div id="errorWrapper" class="errorMsg hidden"></div>

    <div id="content">
        <div id="mainCont" class="flexCol">
            <div id="loginState" class="hidden">
                <p>
                    <span class="i18n">This plugin help you search references by author, title or year in your own library.</span>
                </p>
                <p>
                    <span class="i18n">To use Zotero you should get an API key.</span>
                    <span class="i18n">Navigate to</span>
                    <a class="i18n" target="_blank" href="https://www.zotero.org/settings/keys">Zotero API settings</a>.
                    <span class="i18n">Create and copy API key into the field below.</span>
                </p>
                <div class="mrtop label">
                    <span class="i18n">API Key</span>
                    <input id="apiKeyField" class="form-control" type="text" placeholder="API Key" />
                    <button id="saveApiKeyBtn" class="i18n"
                        style="margin-top: 16px; width: 100%;">Save</button>
                    <div id="apiKeyMessage"></div>
                </div>
                <p id="useDesktopApp">
                    <span class="i18n">Click</span>
                    <b class="i18n">Connect to Local Zotero</b>
                    <span class="i18n">to access your local Zotero library.</span>
                    <span class="i18n">No API key required.</span>
                    <button id="connectToLocalZotero" class="i18n"
                        style="margin-top: 16px; width: 100%;">Connect to Local Zotero</button>
                <div id="useDesktopMessage"></div>
                </p>
                <p>
                    <span class="i18n">Click</span>
                    <b class="i18n">Unlink citations</b>
                    <span class="i18n">to replace all active Zotero citations and Bibliography with plain text.</span>
                    <span class="i18n"></span>After conversion, citations can no longer be updated.</span>
                </p>
                <button id="saveAsTextBtn" class="i18n" style="width: 100%;">Unlink citations</button>
            </div>
            <div id="mainState" class="flexCol flexSize hidden">
                <label for="searchField" class="i18n">Search the references you want to cite in this document.</label>
                <div id="searchWrapper">
                    <div id="librarySelectList"></div>
                    <input id="searchField" autocomplete="off" class="form-control i18n" type="text"
                        placeholder="Search references by author, title" />
                    <button id="filterButton">
                        <svg width="12" height="11" viewBox="0 0 12 11" fill="currentcolor" xmlns="http://www.w3.org/2000/svg">
                            <path d="M5 9L7 11V5L12 0H0L5 5V9Z" fill="currentcolor" fill-opacity="0.8" />
                        </svg>
                    </button>
                </div>
                <div id="docsWrapper" class="flexSize">
                    <div class="flexCol flexSize">
                        <div id="docsHolder" class="flexCol"></div>
                        <div class="flex flexCenter">
                            <div id="libLoader" class="cssload-loading hidden"><i></i><i></i><i></i><i></i></div>
                        </div>
                    </div>
                    <div id="docsThumb" class="scrollThumb hidden"></div>
                </div>
                <div id="selectedWrapper" class="hidden">
                    <div class="flexCol flexSize flexCenter">
                        <div id="selectedHolder"></div>
                    </div>
                    <div id="selectedThumb" class="scrollThumb hidden"></div>
                </div>
                <div id="selectedInfo" class="hidden">
                    <span id="selectedCount">0 selected</span>
                    <span id="cancelBtn" class="i18n link">Cancel selection</span>
                </div>
                <div id="controlsHolder" class="flexCol">
                    <div id="buttonsWrapper" class="flex" style="justify-content: space-between;">
                        <button id="insertLinkBtn" class="i18n" disabled>Insert Citation</button>
                        <button id="settingsBtn">
                            <svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path fill-rule="evenodd" clip-rule="evenodd" d="M7.07031 10C8.72717 10 10.0703 8.65685 10.0703 7C10.0703 5.34315 8.72717 4 7.07031 4C5.41346 4 4.07031 5.34315 4.07031 7C4.07031 8.65685 5.41346 10 7.07031 10ZM9.07031 7C9.07031 8.10457 8.17488 9 7.07031 9C5.96574 9 5.07031 8.10457 5.07031 7C5.07031 5.89543 5.96574 5 7.07031 5C8.17488 5 9.07031 5.89543 9.07031 7Z" fill="currentcolor" fill-opacity="0.8"/>
                                <path fill-rule="evenodd" clip-rule="evenodd" d="M12.4834 11.7324L13.9299 9.30047C14.0421 9.10329 14.0196 8.94992 13.8626 8.84038L12.3488 7.69014C12.3712 7.53678 12.3825 7.30673 12.3825 7C12.3825 6.69327 12.3712 6.46322 12.3488 6.30986L13.8626 5.15962C14.0196 5.05008 14.0421 4.89671 13.9299 4.69953L12.4834 2.26761C12.3937 2.11424 12.2479 2.07042 12.0461 2.13615L10.2631 2.82629C9.88186 2.54147 9.47817 2.31142 9.05206 2.13615L8.78294 0.295775C8.73809 0.0985915 8.62595 0 8.44654 0H5.55346C5.37405 0 5.26191 0.0985915 5.21706 0.295775L4.94794 2.13615C4.61153 2.26761 4.20785 2.49765 3.73688 2.82629L1.95394 2.13615C1.7521 2.07042 1.60633 2.11424 1.51662 2.26761L0.0700841 4.69953C-0.0420505 4.89671 -0.0196235 5.05008 0.137365 5.15962L1.65118 6.30986C1.62875 6.46322 1.61754 6.69327 1.61754 7C1.61754 7.30673 1.62875 7.53678 1.65118 7.69014L0.137365 8.84038C-0.0196235 8.94992 -0.0420505 9.10329 0.0700841 9.30047L1.51662 11.7324C1.60633 11.8858 1.7521 11.9296 1.95394 11.8638L3.73688 11.1737C4.11814 11.4585 4.52183 11.6886 4.94794 11.8638L5.21706 13.7042C5.26191 13.9014 5.37405 14 5.55346 14H8.44654C8.62595 14 8.73809 13.9014 8.78294 13.7042L9.05206 11.8638C9.38847 11.7324 9.79215 11.5023 10.2631 11.1737L12.0461 11.8638C12.2479 11.9296 12.3937 11.8858 12.4834 11.7324ZM11.3593 7.54545L11.274 8.12935L12.7816 9.2749L11.9107 10.7391L10.1275 10.0489L9.69087 10.3536C9.25147 10.6602 8.92091 10.8415 8.6881 10.9324L8.14669 11.144L7.87529 13H6.12472L5.85501 11.1557L5.32835 10.939C4.98235 10.7967 4.65163 10.6088 4.33537 10.3726L3.89201 10.0414L2.08935 10.7391L1.2184 9.2749L2.72604 8.12935L2.64066 7.54545C2.6291 7.46641 2.61754 7.2955 2.61754 7C2.61754 6.7045 2.6291 6.53359 2.64066 6.45455L2.72604 5.87065L1.2184 4.7251L2.08935 3.26086L3.87247 3.95107L4.30913 3.64637C4.74853 3.33976 5.07909 3.15854 5.3119 3.06756L5.85331 2.856L6.12472 1H7.87529L8.14499 2.84433L8.67165 3.06097C9.01765 3.20329 9.34837 3.39116 9.66463 3.62742L10.108 3.95864L11.9107 3.26086L12.7816 4.7251L11.274 5.87065L11.3593 6.45455C11.3709 6.53359 11.3825 6.7045 11.3825 7C11.3825 7.2955 11.3709 7.46641 11.3593 7.54545Z" fill="currentcolor" fill-opacity="0.8"/>
                            </svg>
                        </button>
                    </div>
                    <button id="insertBibBtn" class="i18n">Insert Bibliography</button>
                    <button id="refreshBtn" class="control i18n">Refresh</button>

                    <div id="omitAuthorDiv">
                        <label for="omitAuthor" class="i18n">Omit Author</label>
                        <input id="omitAuthor" type="checkbox" class="form-control i18n" title="Omit Author">
                    </div>
                </div>
                <div id="prefixSuffixDiv">
                    <input id="prefixField" autocomplete="off" class="form-control i18n" type="text"
                        placeholder="Prefix" />
                    <input id="suffixField" autocomplete="off" class="form-control i18n" type="text"
                        placeholder="Suffix" />
                </div>
                <div id="styleWrapper">
                    <div class="label">
                        <label for="styleSelect" class="i18n">Style</label>
                        <div class="selectHolder">
                            <input id="styleSelect" class="form-control control select text i18n" type="text"
                                placeholder="Enter style name" autocomplete="off">
                            <div id="styleSelectList" class="selectList hidden">
                            </div>
                            <div id="styleSelectedListOther" class="selectList hidden form-control"></div>
                        </div>
                    </div>
                    <div class="label styleWrapperSecond">
                        <label for="styleLang" class="i18n">Language</label>
                        <div class="selectHolder">
                            <input id="styleLang" readonly class="form-control control select" type="text">
                            <div id="styleLangList" class="selectList hidden">
                                <span data-value="af-ZA">Afrikaans</span>
                                <span data-value="ar">Arabic</span>
                                <span data-value="bg-BG">Bulgarian</span>
                                <span data-value="ca-AD">Catalan</span>
                                <span data-value="cs-CZ">Czech</span>
                                <span data-value="cy-GB">Welsh</span>
                                <span data-value="da-DK">Danish</span>
                                <span data-value="de-AT">German (Austria)</span>
                                <span data-value="de-CH">German (Switzerland)</span>
                                <span data-value="de-DE">German (Germany)</span>
                                <span data-value="el-GR">Greek</span>
                                <span data-value="en-GB">English (UK)</span>
                                <span data-value="en-US">English (US)</span>
                                <span data-value="es-CL">Spanish (Chile)</span>
                                <span data-value="es-ES">Spanish (Spain)</span>
                                <span data-value="es-MX">Spanish (Mexico)</span>
                                <span data-value="et-EE">Estonian</span>
                                <span data-value="eu">Basque</span>
                                <span data-value="fa-IR">Persian</span>
                                <span data-value="fi-FI">Finnish</span>
                                <span data-value="fr-CA">French (Canada)</span>
                                <span data-value="fr-FR">French (France)</span>
                                <span data-value="he-IL">Hebrew</span>
                                <span data-value="hr-HR">Croatian</span>
                                <span data-value="hu-HU">Hungarian</span>
                                <span data-value="id-ID">Indonesian</span>
                                <span data-value="is-IS">Icelandic</span>
                                <span data-value="it-IT">Italian</span>
                                <span data-value="ja-JP">Japanese</span>
                                <span data-value="km-KH">Khmer</span>
                                <span data-value="ko-KR">Korean</span>
                                <span data-value="la">Latin</span>
                                <span data-value="lt-LT">Lithuanian</span>
                                <span data-value="lv-LV">Latvian</span>
                                <span data-value="mn-MN">Mongolian</span>
                                <span data-value="nb-NO">Norwegian (Bokmål)</span>
                                <span data-value="nl-NL">Dutch</span>
                                <span data-value="nn-NO">Norwegian (Nynorsk)</span>
                                <span data-value="pl-PL">Polish</span>
                                <span data-value="pt-BR">Portuguese (Brazil)</span>
                                <span data-value="pt-PT">Portuguese (Portugal)</span>
                                <span data-value="ro-RO">Romanian</span>
                                <span data-value="ru-RU">Russian</span>
                                <span data-value="sk-SK">Slovak</span>
                                <span data-value="sl-SI">Slovenian</span>
                                <span data-value="sr-RS">Serbian</span>
                                <span data-value="sv-SE">Swedish</span>
                                <span data-value="th-TH">Thai</span>
                                <span data-value="tr-TR">Turkish</span>
                                <span data-value="uk-UA">Ukrainian</span>
                                <span data-value="vi-VN">Vietnamese</span>
                                <span data-value="zh-CN">Chinese (PRC)</span>
                                <span data-value="zh-TW">Chinese (Taiwan)</span>
                            </div>
                        </div>
                    </div>
                </div>
                <div id="notesStyle" class="notesStyle hidden">
                    <span class="i18n">Display citations as:</span>
                    <div class="radioHolder">
                        <input type="radio" id="footNotes" class="form-control" value="footnotes" name="notesAs"
                            checked />
                        <label for="footNotes" class="i18n">Footnotes</label>
                        <input type="radio" id="endNotes" class="form-control" value="endnotes" name="notesAs" />
                        <label for="endNotes" class="i18n">Endnotes</label>
                    </div>
                </div>
            </div>
        </div>

        <div id="footerCont">
            <span>
                <a href="https://www.zotero.org/" target="_blank" id="zotero-link" class="link i18n">
                    Open Zotero website
                </a>
            </span>
            <span id="logoutLink" class="link i18n">Reconfigure</span>
        </div>

        <input type="file" id="cslFileInput" accept=".csl,.xml" style="display: none;" />

    </div>
</body>

</html>